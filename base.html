<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>StockPage JS Attempt</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>




</head>

<body>
    <form>
        <input type="text" placeholder="Date" id="Date">
        <input type="text" placeholder="Stock 1" id="s1">
        <input type="text" placeholder="Stock 2" id="s2">

        <button type="button" onclick="getInputValue(); ">Submit</button>
    </form>

    <div><canvas id="myChart"></canvas></div>

    <script>
        function getInputValue() {
            // Selecting the input element and get its value 
            var inputDate = document.getElementById("Date").value;
            var inputS1 = document.getElementById("s1").value;
            var inputS2 = document.getElementById("s2").value;

            const dates = [];
            const closes1 = [];
            const closes2 = [];

            let url1 = "http://api.marketstack.com/v1/eod?access_key=469ed3642bddff1dee77e5b1332ce3b7&symbols=";
            let url2 = "&date_from=";
            let urlTotal = url1.concat(inputS1).concat(url2).concat(inputDate);

            async function callAPI1() {
                let response = await fetch(urlTotal);
                let text = await response.json();

                let dataArray = text.data;
                for (let i = 0; i < dataArray.length; i++) {
                    closes1.push(dataArray[i].close);
                    dates.push(dataArray[i].date);

                }
            }
            callAPI1();

            let urlTotal2 = url1.concat(inputS2).concat(url2).concat(inputDate);
            async function callAPI2() {
                let response = await fetch(urlTotal2);
                let text = await response.json();

                let dataArray = text.data
                for (let i = 0; i < dataArray.length; i++) {
                    closes2.push(dataArray[i].close);

                }

            }
            callAPI2();



        }

        console.log("first")
        let myChart = document.getElementById("myChart").getContext("2d");
        new Chart(document.getElementById("myChart"), {
            type: 'bar',
            data: {
                labels: ["Africa", "Asia", "Europe", "Latin America", "North America"],
                datasets: [
                    {
                        label: "Population (millions)",
                        backgroundColor: ["#3e95cd", "#8e5ea2", "#3cba9f", "#e8c3b9", "#c45850"],
                        data: [2478, 5267, 734, 784, 433]
                    }
                ]
            },
            options: {
                legend: { display: false },
                title: {
                    display: true,
                    text: 'Predicted world population (millions) in 2050'
                }
            }
        });

        let lineChart = new Chart(myChart, {
            type: "line",
            data: {
                labels: ["One", "Two", "Three"],
                dataset: [{
                    label: "Closing Price",
                    data: [5, 10, 15]

                }]
            },
            options: {}

        });
        console.log("second")

    </script>




</body>

</html>